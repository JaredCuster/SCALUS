#!/usr/bin/perl

#This example perl script is used to customise an rdp file generated by scalus before presenting it to Microsoft Remote Desktop
my $filename=$ARGV[0];

my %settings = qw(
    desktopwidth   1024
    desktopheight  1024
);

if ((not defined $filename) or 
	(not (-e $filename)) or
	(not (-r $filename)) or
	(not (-w $filename)))
{
    print "ERROR:invalid file: ${filename}\n";
    exit;
}

my $tmpfile = "${filename}.tmp";
open(DATA, "<${filename}") or die "ERROR:Couldnt open file ${filename}, $!";
open(TOFILE, ">${tmpfile}") or die "ERROR:Couldnt open file ${tmpfile}, $!";
while (<DATA>){
	my ($key, $val) = split /=/, $_;
	if (exists $settings{$key}) {
		$val=$settings{$key};
		print TOFILE "${key}  = ${val}\n";
	} else {
		print TOFILE $_;
	}

}
close (DATA);
close (TOFILE);
unlink(${filename});
rename(${tmpfile}, ${filename});
